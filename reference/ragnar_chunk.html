<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Chunk text — ragnar_chunk • ragnar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chunk text — ragnar_chunk"><meta name="description" content="Functions for chunking text into smaller pieces while preserving meaningful
semantics. These functions provide flexible ways to split text based on
various boundaries (sentences, words, etc.) while controlling chunk sizes and
overlap."><meta property="og:description" content="Functions for chunking text into smaller pieces while preserving meaningful
semantics. These functions provide flexible ways to split text based on
various boundaries (sentences, words, etc.) while controlling chunk sizes and
overlap."><meta property="og:image" content="https://t-kalinowski.github.io/ragnar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ragnar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Chunk text</h1>

      <div class="d-none name"><code>ragnar_chunk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions for chunking text into smaller pieces while preserving meaningful
semantics. These functions provide flexible ways to split text based on
various boundaries (sentences, words, etc.) while controlling chunk sizes and
overlap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ragnar_chunk</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">1600L</span>,</span>
<span>  boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"paragraph"</span>, <span class="st">"sentence"</span>, <span class="st">"line_break"</span>, <span class="st">"word"</span>, <span class="st">"character"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  trim <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ragnar_segment</span><span class="op">(</span><span class="va">x</span>, boundaries <span class="op">=</span> <span class="st">"sentence"</span>, <span class="va">...</span>, trim <span class="op">=</span> <span class="cn">FALSE</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ragnar_chunk_segments</span><span class="op">(</span><span class="va">x</span>, max_size <span class="op">=</span> <span class="fl">1600L</span>, <span class="va">...</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A character vector, list of character vectors, or data frame containing a <code>text</code> column.</p></dd>


<dt id="arg-max-size">max_size<a class="anchor" aria-label="anchor" href="#arg-max-size"></a></dt>
<dd><p>Integer. The maximum number of characters in each chunk.
Defaults to <code>1600</code>, which typically is approximately 400 tokens, or 1 page of text.</p></dd>


<dt id="arg-boundaries">boundaries<a class="anchor" aria-label="anchor" href="#arg-boundaries"></a></dt>
<dd><p>A sequence of boundary types to use in order until
<code>max_size</code> is satisfied. Valid values are <code>"sentence"</code>, <code>"word"</code>,
<code>"line_break"</code>, <code>"character"</code>, <code>"paragraph"</code>, or a <code>stringr_pattern</code> object
like <code><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">stringr::fixed()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to internal functions.
tokenizer to use <code>tokens</code> instead of characters as the count (not fully
implemented yet)</p></dd>


<dt id="arg-trim">trim<a class="anchor" aria-label="anchor" href="#arg-trim"></a></dt>
<dd><p>logical, whether to trim leading and trailing whitespace from
strings. Default <code>TRUE</code>.</p></dd>


<dt id="arg-simplify">simplify<a class="anchor" aria-label="anchor" href="#arg-simplify"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the output is simplified. If <code>FALSE</code>,
returns a vector that has the same length as <code>x</code>. If <code>TRUE</code>, character
strings are <code><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist()</a></code>ed, and dataframes are <code><a href="https://tidyr.tidyverse.org/reference/chop.html" class="external-link">tidyr::unchop()</a></code>ed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>For character input with <code>simplify = FALSE</code>: A list of character vectors</p></li>
<li><p>For character input with <code>simplify = TRUE</code>: A character vector of chunks</p></li>
<li><p>For data frame input with <code>simplify = FALSE</code>: A data frame with the same number of rows as the input, where the
<code>text</code> column transformed into a list of chararacter vectors.</p></li>
<li><p>For data frame input with <code>simplify = TRUE</code>: Same as a data frame input with <code>simplify=FALSE</code>, with the
<code>text</code> column expanded by <code><a href="https://tidyr.tidyverse.org/reference/chop.html" class="external-link">tidyr::unchop()</a></code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Chunking is the combination of two fundamental operations:</p><ul><li><p>identifying boundaries: finding character positions where it makes sense to split a string.</p></li>
<li><p>extracting slices: extracting substrings using the candidate boundaries to produce chunks that
match the requested <code>chunk_size</code> and <code>chunk_overlap</code></p></li>
</ul><p><code>ragnar_chunk()</code> is a higher-level function that does both, identifies boundaries and extracts slices.</p>
<p>If you need lower-level control, you can alternatively use the lower-level functions
<code>ragnar_segment()</code> in combination with <code>ragnar_chunk_segments()</code>.</p>
<p><code>ragnar_segment()</code>: Splits text at semantic boundaries.</p>
<p><code>ragnar_chunk_segments()</code>: Combines text segments into chunks.</p>
<p>For most usecases, these two are equivalent:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ragnar_chunk.html">ragnar_chunk</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ragnar_chunk.html">ragnar_segment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ragnar_chunk.html">ragnar_chunk_segments</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p>When working with data frames, these functions preserve all columns and use
<code><a href="https://tidyr.tidyverse.org/reference/chop.html" class="external-link">tidyr::unchop()</a></code> to handle the resulting list-columns when <code>simplify = TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic chunking with max size</span></span></span>
<span class="r-in"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"This is a long piece of text. It has multiple sentences.</span></span></span>
<span class="r-in"><span><span class="st">         We want to split it into chunks. Here's another sentence."</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="co"># splits at sentences</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece of text."    "It has multiple sentences."      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "We want to split it into chunks." "Here's another sentence."        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># smaller chunk size: first splits at sentence boundaries, then word boundaries</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece" "of text."             "It has multiple"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "sentences."           "We want to split it"  "into chunks."        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "Here's another"       "sentence."           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># only split at sentence boundaries. Note, some chunks are oversized</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">20</span>, boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sentence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece of text."    "It has multiple sentences."      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "We want to split it into chunks." "Here's another sentence."        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># only consider word boundaries when splitting:</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">20</span>, boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece" "of text. It has"      "multiple sentences." </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "We want to"           "split it into chunks" "s. Here's another"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "sentence."           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first split at sentence boundaries, then word boundaries,</span></span></span>
<span class="r-in"><span><span class="co"># as needed to satisfy `max_chunk`</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">20</span>, boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sentence"</span>, <span class="st">"word"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece" "of text."             "It has multiple"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "sentences."           "We want to split it"  "into chunks."        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "Here's another"       "sentence."           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a stringr pattern to find semantic boundaries</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">10</span>, boundaries <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">fixed</a></span><span class="op">(</span><span class="st">". "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This is a long piece of text."                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "It has multiple sentences.\n         We want to split it into chunks."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "Here's another sentence."                                             </span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">10</span>, boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">fixed</a></span><span class="op">(</span><span class="st">". "</span><span class="op">)</span>, <span class="st">"word"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "This is a"  "long piece" "e of text." "It has"     "multiple"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "sentences." "."          "We want to" "o split it" "into"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "chunks."    "Here's"     "another"    "sentence." </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Working with data frames</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First sentence. Second sentence."</span>, <span class="st">"Another sentence here."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">df</span>, max_size <span class="op">=</span> <span class="fl">20</span>, boundaries <span class="op">=</span> <span class="st">"sentence"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id                   text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1        First sentence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1       Second sentence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2 Another sentence here.</span>
<span class="r-in"><span><span class="fu">ragnar_chunk</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">text</span>, max_size <span class="op">=</span> <span class="fl">20</span>, boundaries <span class="op">=</span> <span class="st">"sentence"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "First sentence."        "Second sentence."       "Another sentence here."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Chunking pre-segmented text</span></span></span>
<span class="r-in"><span><span class="va">segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First segment. "</span>, <span class="st">"Second segment. "</span>, <span class="st">"Third segment. "</span>, <span class="st">"Fourth segment. "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ragnar_chunk_segments</span><span class="op">(</span><span class="va">segments</span>, max_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "First segment."  "Second segment." "Third segment."  "Fourth segment."</span>
<span class="r-in"><span><span class="fu">ragnar_chunk_segments</span><span class="op">(</span><span class="va">segments</span>, max_size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "First segment. Second segment." "Third segment. Fourth segment."</span>
<span class="r-in"><span><span class="fu">ragnar_chunk_segments</span><span class="op">(</span><span class="va">segments</span>, max_size <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "First segment. Second segment. Third segment."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "Fourth segment."                              </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

