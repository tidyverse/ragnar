<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Retrieval-Augmented Generation (RAG) Workflows • ragnar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Retrieval-Augmented Generation (RAG) Workflows">
<meta name="description" content='Provides tools for implementing Retrieval-Augmented Generation (RAG) workflows with Large Language Models (LLM). Includes functions for document processing, text chunking, embedding generation, storage management, and content retrieval. Supports various document types and embedding providers (Ollama, OpenAI), with DuckDB as the default storage backend. Integrates with the ellmer package to equip chat objects with retrieval capabilities. Designed to offer both sensible defaults and customization options with transparent access to intermediate outputs. For a review of retrieval-augmented generation methods, see Gao et al. (2023) "Retrieval-Augmented Generation for Large Language Models: A Survey" &lt;doi:10.48550/arXiv.2312.10997&gt;.'>
<meta property="og:description" content='Provides tools for implementing Retrieval-Augmented Generation (RAG) workflows with Large Language Models (LLM). Includes functions for document processing, text chunking, embedding generation, storage management, and content retrieval. Supports various document types and embedding providers (Ollama, OpenAI), with DuckDB as the default storage backend. Integrates with the ellmer package to equip chat objects with retrieval capabilities. Designed to offer both sensible defaults and customization options with transparent access to intermediate outputs. For a review of retrieval-augmented generation methods, see Gao et al. (2023) "Retrieval-Augmented Generation for Large Language Models: A Survey" &lt;doi:10.48550/arXiv.2312.10997&gt;.'>
<meta property="og:image" content="https://ragnar.tidyverse.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="ragnar.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ragnar</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/ragnar.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/ragnar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ragnar-">ragnar <a class="anchor" aria-label="anchor" href="#ragnar-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<p><code>ragnar</code> is an R package that helps implement Retrieval-Augmented Generation (RAG) workflows. It focuses on providing a complete solution with sensible defaults, while still giving the knowledgeable user precise control over each step. We don’t believe that you can fully automate the creation of a good RAG system, so it’s important that <code>ragnar</code> is not a black box. <code>ragnar</code> is designed to be transparent. You can easily inspect outputs at intermediate steps to understand what’s happening.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install ragnar from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ragnar"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version from GitHub with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"tidyverse/ragnar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-steps">Key Steps<a class="anchor" aria-label="anchor" href="#key-steps"></a>
</h2>
<div class="section level3">
<h3 id="id_1-document-processing">1. Document Processing<a class="anchor" aria-label="anchor" href="#id_1-document-processing"></a>
</h3>
<p><code>ragnar</code> works with a wide variety of document types, using <a href="https://github.com/microsoft/markitdown" class="external-link">MarkItDown</a> to convert content to Markdown.</p>
<p>Key functions:</p>
<ul>
<li>
<code><a href="reference/read_as_markdown.html">read_as_markdown()</a></code>: Convert a file or URL to markdown</li>
<li>
<code><a href="reference/ragnar_find_links.html">ragnar_find_links()</a></code>: Find all links in a webpage</li>
</ul>
</div>
<div class="section level3">
<h3 id="id_2-text-chunking">2. Text Chunking<a class="anchor" aria-label="anchor" href="#id_2-text-chunking"></a>
</h3>
<p>Next we divide each document into chunks. Ragnar defaults to a strategy that preserves some of the semantics of the document, but provides plenty of opportunities to tweak the approach.</p>
<p>Key functions:</p>
<ul>
<li>
<code><a href="reference/markdown_chunk.html">markdown_chunk()</a></code>: Full-featured chunker that identifies semantic boundaries and intelligently chunks text.</li>
</ul>
</div>
<div class="section level3">
<h3 id="id_3-context-augmentation-optional">3. Context Augmentation (Optional)<a class="anchor" aria-label="anchor" href="#id_3-context-augmentation-optional"></a>
</h3>
<p>RAG applications benefit from augmenting text chunks with additional context, such as document headings and subheadings. <code>ragnar</code> makes it easy to keep track of headings and subheadings as part of chunking.</p>
<p><code><a href="reference/markdown_chunk.html">markdown_chunk()</a></code> automatically associates each chunk with the headings that are in scope for that chunk.</p>
</div>
<div class="section level3">
<h3 id="id_4-embedding">4. Embedding<a class="anchor" aria-label="anchor" href="#id_4-embedding"></a>
</h3>
<p><code>ragnar</code> can help compute embeddings for each chunk. The goal is for <code>ragnar</code> to provide access to embeddings from popular LLM providers.</p>
<p>Key functions:</p>
<ul>
<li><code><a href="reference/embed_ollama.html">embed_ollama()</a></code></li>
<li><code><a href="reference/embed_ollama.html">embed_openai()</a></code></li>
<li><code><a href="reference/embed_bedrock.html">embed_bedrock()</a></code></li>
<li><code><a href="reference/embed_databricks.html">embed_databricks()</a></code></li>
<li><code><a href="reference/embed_google_vertex.html">embed_google_vertex()</a></code></li>
</ul>
<p>Note that calling the embedding function directly is typically not necessary. Instead, the embedding function is specified when a store is first created, and then automatically called when needed by <code><a href="reference/ragnar_retrieve.html">ragnar_retrieve()</a></code> and <code><a href="reference/ragnar_store_insert.html">ragnar_store_insert()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="id_5-storage">5. Storage<a class="anchor" aria-label="anchor" href="#id_5-storage"></a>
</h3>
<p>Processed data is stored in a format optimized for efficient searching, using <code>duckdb</code> by default. The API is designed to be extensible, allowing additional packages to implement support for different storage providers.</p>
<p>Key functions:</p>
<ul>
<li><code><a href="reference/ragnar_store_create.html">ragnar_store_create()</a></code></li>
<li><code><a href="reference/ragnar_store_create.html">ragnar_store_connect()</a></code></li>
<li><code><a href="reference/ragnar_store_insert.html">ragnar_store_insert()</a></code></li>
</ul>
</div>
<div class="section level3">
<h3 id="id_6-retrieval">6. Retrieval<a class="anchor" aria-label="anchor" href="#id_6-retrieval"></a>
</h3>
<p>Given a prompt, retrieve related chunks based on embedding distance or bm25 text search.</p>
<p>Key functions:</p>
<ul>
<li>
<code><a href="reference/ragnar_retrieve.html">ragnar_retrieve()</a></code>: high-level function that performs both <code>vss</code> and <code>bm25</code> search and de-overlaps retrieved results.</li>
<li>
<code><a href="reference/ragnar_retrieve_vss.html">ragnar_retrieve_vss()</a></code>: Retrieve using <a href="https://duckdb.org/docs/stable/core_extensions/vss" class="external-link"><code>vss</code> DuckDB extension</a>
</li>
<li>
<code><a href="reference/ragnar_retrieve_bm25.html">ragnar_retrieve_bm25()</a></code>: Retrieve using <a href="https://duckdb.org/docs/stable/core_extensions/full_text_search" class="external-link"><code>full-text search DuckDB extension</code></a>
</li>
<li>
<code><a href="reference/chunks_deoverlap.html">chunks_deoverlap()</a></code>: Consolidates retrieved chunks that overlap.</li>
</ul>
</div>
<div class="section level3">
<h3 id="id_7-chat-augmentation">7. Chat Augmentation<a class="anchor" aria-label="anchor" href="#id_7-chat-augmentation"></a>
</h3>
<p><code>ragnar</code> can equip an <code><a href="https://ellmer.tidyverse.org/reference/Chat.html" class="external-link">ellmer::Chat</a></code> object with a retrieve tool that enables an LLM to retrieve content from a store on-demand.</p>
<ul>
<li>
<code>ragnar_register_tool_retrieve(chat, store)</code>.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Here’s an example of using <code>ragnar</code> to create a knowledge store from the <em>R for Data Science (2e)</em> book:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ragnar.tidyverse.org/">ragnar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">base_url</span> <span class="op">&lt;-</span> <span class="st">"https://r4ds.hadley.nz"</span></span>
<span><span class="va">pages</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ragnar_find_links.html">ragnar_find_links</a></span><span class="op">(</span><span class="va">base_url</span><span class="op">)</span></span>
<span></span>
<span><span class="va">store_location</span> <span class="op">&lt;-</span> <span class="st">"r4ds.ragnar.duckdb"</span></span>
<span></span>
<span><span class="va">store</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ragnar_store_create.html">ragnar_store_create</a></span><span class="op">(</span></span>
<span>  <span class="va">store_location</span>,</span>
<span>  embed <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">ragnar</span><span class="fu">::</span><span class="fu"><a href="reference/embed_ollama.html">embed_openai</a></span><span class="op">(</span><span class="va">x</span>, model <span class="op">=</span> <span class="st">"text-embedding-3-small"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">page</span> <span class="kw">in</span> <span class="va">pages</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ingesting: "</span>, <span class="va">page</span><span class="op">)</span></span>
<span>  <span class="va">chunks</span> <span class="op">&lt;-</span> <span class="va">page</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/read_as_markdown.html">read_as_markdown</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/markdown_chunk.html">markdown_chunk</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/ragnar_store_insert.html">ragnar_store_insert</a></span><span class="op">(</span><span class="va">store</span>, <span class="va">chunks</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/arrow.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/base-R.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/communicate.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/communication.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/data-import.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/data-tidy.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/data-transform.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/data-visualize.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/databases.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/datetimes.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/EDA.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/factors.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/functions.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/import.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/intro.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/iteration.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/joins.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/layers.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/logicals.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/missing-values.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/numbers.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/preface-2e.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/program.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/quarto-formats.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/quarto.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/rectangling.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/regexps.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/spreadsheets.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/strings.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/transform.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/visualize.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/webscraping.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/whole-game.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/workflow-basics.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/workflow-help.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/workflow-scripts.html</span></span>
<span><span class="co">#&gt; ingesting: https://r4ds.hadley.nz/workflow-style.html</span></span>
<span></span>
<span><span class="fu"><a href="reference/ragnar_store_build_index.html">ragnar_store_build_index</a></span><span class="op">(</span><span class="va">store</span><span class="op">)</span></span></code></pre></div>
<p>Once the store is set up, you can then retrieve the most relevant text chunks.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' ## Retrieving Chunks</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ragnar.tidyverse.org/">ragnar</a></span><span class="op">)</span></span>
<span><span class="va">store_location</span> <span class="op">&lt;-</span> <span class="st">"r4ds.ragnar.duckdb"</span></span>
<span><span class="va">store</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ragnar_store_create.html">ragnar_store_connect</a></span><span class="op">(</span><span class="va">store_location</span>, read_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"How can I subset a dataframe with a logical vector?"</span></span>
<span></span>
<span></span>
<span><span class="co">#' # Retrieving Chunks</span></span>
<span><span class="co">#' Once the store is set up, retrieve the most relevant text chunks like this</span></span>
<span></span>
<span><span class="op">(</span><span class="va">relevant_chunks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ragnar_retrieve.html">ragnar_retrieve</a></span><span class="op">(</span><span class="va">store</span>, <span class="va">text</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 9</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;   origin         doc_id chunk_id start   end cosine_distance bm25  context text </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;list&gt; &lt;list&gt;   &lt;int&gt; &lt;int&gt; &lt;list&gt;          &lt;lis&gt; &lt;chr&gt;   &lt;chr&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1 https://r4ds.… &lt;int&gt;  &lt;int&gt;     2192  4007 &lt;dbl [1]&gt;       &lt;dbl&gt; "# 25 … "```…</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 2 https://r4ds.… &lt;int&gt;  &lt;int&gt;     1622  4205 &lt;dbl [2]&gt;       &lt;dbl&gt; "# 12 … "```…</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 3 https://r4ds.… &lt;int&gt;  &lt;int&gt;    19379 20792 &lt;dbl [1]&gt;       &lt;dbl&gt; "# 12 … "Tha…</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 4 https://r4ds.… &lt;int&gt;  &lt;int&gt;    12795 15259 &lt;dbl [2]&gt;       &lt;dbl&gt; "# 24 … "The…</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co">#'  Register ellmer tool</span></span>
<span><span class="co">#' You can register an ellmer tool to let the LLM retrieve chunks.</span></span>
<span><span class="va">system_prompt</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_squish</a></span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  You are an expert R programmer and mentor. You are concise.</span></span>
<span><span class="st"></span></span>
<span><span class="st">  Before responding, retrieve relevant material from the knowledge store. Quote or</span></span>
<span><span class="st">  paraphrase passages, clearly marking your own words versus the source. Provide a</span></span>
<span><span class="st">  working link for every source cited, as well as any additional relevant links.</span></span>
<span><span class="st">  Do not answer unless you have retrieved and cited a source.</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/chat_openai.html" class="external-link">chat_openai</a></span><span class="op">(</span></span>
<span>  <span class="va">system_prompt</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"gpt-4.1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/ragnar_register_tool_retrieve.html">ragnar_register_tool_retrieve</a></span><span class="op">(</span><span class="va">chat</span>, <span class="va">store</span>, top_k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"How can I subset a dataframe?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ◯ [tool call] rag_retrieve_from_store_001(text = "How to subset a dataframe in</span></span>
<span><span class="co">#&gt; R")</span></span>
<span><span class="co">#&gt; ● #&gt; [{"origin":"https://r4ds.hadley.nz/arrow.html","doc_id":2,"chunk_id":13,"…</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#&gt; You can subset a dataframe in R in several ways:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1. Using the [ (bracket) operator:</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; - Select rows and/or columns: df[rows, cols]</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; - Example:</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; ```r</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; df[1, 2]          # first row, second column</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; df[, c("x","y")]  # all rows, columns x and y</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; df[df$x &gt; 1, ]    # rows where x &gt; 1, all columns</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; ```</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; If df is a tibble, the result of df[, "x"] is always a tibble; for a </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; data.frame, it returns a vector unless you use drop=FALSE: df[, "x", </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; drop=FALSE] </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; ([source](https://r4ds.hadley.nz/base-R.html#subsetting-data-frames)).</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 2. With dplyr for more readable code:</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; - Use filter() for subsetting rows and select() for columns:</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; ```r</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; library(dplyr)</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; df %&gt;% filter(x &gt; 1)            # rows where x &gt; 1</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; df %&gt;% select(x, y)             # columns x and y</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; df %&gt;% filter(x &gt; 1) %&gt;% select(x, y)  # both</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; ```</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; - Many dplyr verbs are wrappers for subsetting, e.g., filter(), arrange(), and </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; select() ([source](https://r4ds.hadley.nz/base-R.html#dplyr-equivalents)).</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; 3. subset() function (base R):</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; ```r</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; subset(df, x &gt; 1, select = c(x, y))</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; ```</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; This combines row/column subsetting in one call.</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; Summary: Use df[rows, cols], dplyr's filter() and select(), or subset() for </span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; subsetting dataframes.</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; - Reference: https://r4ds.hadley.nz/base-R.html#subsetting-data-frames</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt; - Reference: https://dplyr.tidyverse.org/reference/filter.html</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; - Reference: https://rdrr.io/r/base/subset.html</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; Let me know if you want an example with your own dataset or more details!</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ragnar" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/tidyverse/ragnar/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tidyverse/ragnar/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ragnar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tomasz Kalinowski <br><small class="roles"> Author, maintainer </small>   </li>
<li>Daniel Falbel <br><small class="roles"> Author </small>   </li>
<li>
<a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a> <br><small class="roles"> Copyright holder, funder </small>  <a href="https://ror.org/03wc8by49" class="external-link"><img src="https://raw.githubusercontent.com/ror-community/ror-logos/main/ror-icon-rgb.svg" class="ror" alt="ROR"></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tidyverse/ragnar/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tidyverse/ragnar/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, Daniel Falbel, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
